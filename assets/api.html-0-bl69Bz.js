import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,a as n,o as e}from"./app-C0B77B6C.js";const l={};function p(t,s){return e(),a("div",null,[...s[0]||(s[0]=[n(`<h2 id="概述" tabindex="-1"><a class="header-anchor" href="#概述"><span>概述</span></a></h2><p>api 是 go-zero 自研的领域特性语言（下文称 api 语言 或 api 描述语言）, 旨在实现人性化的基础描述语言, 作为生成 HTTP 服务最基本的描述语言.</p><p>jzero 扩展了 api 语法, 支持了一下特性:</p><ul><li><code>go_package</code>: 将 go types 生成在定义的 package 中, 所以能支持不同 api 文件的 type 定义可以同名, 保持和 proto 中的 <code>go_package</code> 一致</li><li><code>compact_handler</code>: 能将同一组路由的 handler 生成在同一个文件中, 减少文件的数量, 保持和 proto 的 server 模块一致</li></ul><h2 id="api-定义" tabindex="-1"><a class="header-anchor" href="#api-定义"><span>api 定义</span></a></h2><div class="language-api line-numbers-mode" data-highlighter="shiki" data-ext="api" data-title="api" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>info (</span></span>
<span class="line"><span>    // 定义 go_package: 生成的 go types 放入的文件夹位置</span></span>
<span class="line"><span>    go_package: &quot;user&quot;</span></span>
<span class="line"><span>)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>type User {</span></span>
<span class="line"><span>    id int \`json:&quot;id&quot;\`</span></span>
<span class="line"><span>    username string \`json:&quot;username&quot;\`</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>type PageRequest {</span></span>
<span class="line"><span>    page int \`form:&quot;page&quot;\`</span></span>
<span class="line"><span>    size int \`form:&quot;size&quot;\`</span></span>
<span class="line"><span>    username string \`form:&quot;username,optional&quot;\` // 过滤参数, 可选</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>type PageResponse {</span></span>
<span class="line"><span>    total uint64 \`json:&quot;total&quot;\` // 总数</span></span>
<span class="line"><span>    list  []User \`json:&quot;list&quot;\`  // 分页数据</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>type UpdateRequest {</span></span>
<span class="line"><span>    id int \`path:&quot;id&quot;\`</span></span>
<span class="line"><span>    username string \`json:&quot;username&quot;\`</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>type UpdateResponse {}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>@server (</span></span>
<span class="line"><span>    prefix:          /api/user // 路由 prefix</span></span>
<span class="line"><span>    group:           user      // 生成的 handler/logic 文件夹位置</span></span>
<span class="line"><span>    jwt:             JwtAuth   // 是否启用 jwt 验证</span></span>
<span class="line"><span>    middleware:      AuthX     // 该组路由的中间件</span></span>
<span class="line"><span>    compact_handler: true      // 是否合并该组的 handler 为同一个文件, 默认每个路由都有 handler 文件</span></span>
<span class="line"><span>)</span></span>
<span class="line"><span>service simpleapi {</span></span>
<span class="line"><span>    @doc &quot;用户分页&quot;</span></span>
<span class="line"><span>    @handler Page</span></span>
<span class="line"><span>    get /page (PageRequest) returns (PageResponse)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    @doc &quot;更新用户&quot;</span></span>
<span class="line"><span>    @handler Update</span></span>
<span class="line"><span>    post /update (UpdateRequest) returns (UpdateResponse)</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>对应的 curl 命令:</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 用户分页接口</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -X</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> GET</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;http://localhost:8080/api/user/page?page=1&amp;size=10&amp;username=test&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  -H</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;Authorization: Bearer &lt;your-jwt-token&gt;&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 更新用户接口</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -X</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> POST</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;http://localhost:8080/api/user/update/123&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  -H</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;Content-Type: application/json&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  -H</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;Authorization: Bearer &lt;your-jwt-token&gt;&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  -d</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;{&quot;username&quot;: &quot;new_username&quot;}&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="api-字段校验" tabindex="-1"><a class="header-anchor" href="#api-字段校验"><span>api 字段校验</span></a></h2><blockquote><p>jzero 默认集成 <a href="https://github.com/go-playground/validator" target="_blank" rel="noopener noreferrer">https://github.com/go-playground/validator</a> 进行字段校验</p></blockquote><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">syntax</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;v1&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">type</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> CreateRequest</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> {</span></span>
<span class="line highlighted"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    name</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">json:&quot;name&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> validate:&quot;gte=2,lte=30&quot;\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> //</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 名称</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="将-types-文件夹按照-go-package-进行分组" tabindex="-1"><a class="header-anchor" href="#将-types-文件夹按照-go-package-进行分组"><span>将 types 文件夹按照 go_package 进行分组</span></a></h2><div class="hint-container important"><p class="hint-container-title">go_package 的选项, 参考自 proto 文件, 能将 message 生成的结构体分组</p><p>在 api 文件中同理, go_package 选项能将定义的 type 生成的结构体分组</p><p>两大优点:</p><ol><li><p>避免默认生成的 types/types.go 爆炸</p></li><li><p>提升开发体验, 不同 group 下的 type 命名不会冲突</p></li></ol></div><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">syntax</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;v1&quot;</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">info</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span></span>
<span class="line highlighted"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">	go_package:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;version&quot;</span></span>
<span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="合并同一个-group-的-handler-为同一个文件" tabindex="-1"><a class="header-anchor" href="#合并同一个-group-的-handler-为同一个文件"><span>合并同一个 group 的 handler 为同一个文件</span></a></h2><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">@server</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">	prefix:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          /api/v1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">	group:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">           system/user</span></span>
<span class="line highlighted"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">	compact_handler:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">service</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> simpleapi</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">	@handler</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> GetUserHandler</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">	get</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /system/user/getUser</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (GetUserRequest) returns (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">GetUserResponse</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">	@handler</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> DeleteUserHandler</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">	get</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /system/user/deleteUser</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (DeleteUserRequest) returns (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">DeleteUserResponse</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,16)])])}const h=i(l,[["render",p],["__file","api.html.vue"]]),c=JSON.parse('{"path":"/guide/api.html","title":"保姆级 api 教程","lang":"zh-CN","frontmatter":{"title":"保姆级 api 教程","icon":"eos-icons:api","star":true,"order":0.2,"description":"概述 api 是 go-zero 自研的领域特性语言（下文称 api 语言 或 api 描述语言）, 旨在实现人性化的基础描述语言, 作为生成 HTTP 服务最基本的描述语言. jzero 扩展了 api 语法, 支持了一下特性: go_package: 将 go types 生成在定义的 package 中, 所以能支持不同 api 文件的 type...","head":[["meta",{"property":"og:url","content":"https://docs.jzero.io/guide/api.html"}],["meta",{"property":"og:site_name","content":"Jzero Framework"}],["meta",{"property":"og:title","content":"保姆级 api 教程"}],["meta",{"property":"og:description","content":"概述 api 是 go-zero 自研的领域特性语言（下文称 api 语言 或 api 描述语言）, 旨在实现人性化的基础描述语言, 作为生成 HTTP 服务最基本的描述语言. jzero 扩展了 api 语法, 支持了一下特性: go_package: 将 go types 生成在定义的 package 中, 所以能支持不同 api 文件的 type..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2026-01-07T08:25:19.000Z"}],["meta",{"property":"article:author","content":"jaronnie"}],["meta",{"property":"article:modified_time","content":"2026-01-07T08:25:19.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"保姆级 api 教程\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2026-01-07T08:25:19.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"jaronnie\\",\\"url\\":\\"https://github.com/jaronnie\\"}]}"]]},"headers":[{"level":2,"title":"概述","slug":"概述","link":"#概述","children":[]},{"level":2,"title":"api 定义","slug":"api-定义","link":"#api-定义","children":[]},{"level":2,"title":"api 字段校验","slug":"api-字段校验","link":"#api-字段校验","children":[]},{"level":2,"title":"将 types 文件夹按照 go_package 进行分组","slug":"将-types-文件夹按照-go-package-进行分组","link":"#将-types-文件夹按照-go-package-进行分组","children":[]},{"level":2,"title":"合并同一个 group 的 handler 为同一个文件","slug":"合并同一个-group-的-handler-为同一个文件","link":"#合并同一个-group-的-handler-为同一个文件","children":[]}],"git":{"createdTime":1724234753000,"updatedTime":1767774319000,"contributors":[{"name":"jaron","email":"jaron@jaronnie.com","commits":3}]},"readingTime":{"minutes":1.93,"words":578},"filePathRelative":"guide/api.md","localizedDate":"2024年8月21日","excerpt":"<h2>概述</h2>\\n<p>api 是 go-zero 自研的领域特性语言（下文称 api 语言 或 api 描述语言）, 旨在实现人性化的基础描述语言, 作为生成 HTTP 服务最基本的描述语言.</p>\\n<p>jzero 扩展了 api 语法, 支持了一下特性:</p>\\n<ul>\\n<li><code>go_package</code>: 将 go types 生成在定义的 package 中, 所以能支持不同 api 文件的 type 定义可以同名, 保持和 proto 中的 <code>go_package</code> 一致</li>\\n<li><code>compact_handler</code>: 能将同一组路由的 handler 生成在同一个文件中, 减少文件的数量, 保持和 proto 的 server 模块一致</li>\\n</ul>","autoDesc":true}');export{h as comp,c as data};
